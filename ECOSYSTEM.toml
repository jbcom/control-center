# Unified Control Center Ecosystem
#
# Single control surface managing:
# - jbcom: Python packages ecosystem (PyPI)
# - FlipsideCrypto: Infrastructure ecosystem (Terraform, AWS, GCP)
#
# This is the source of truth for all managed resources.

[ecosystem]
name = "unified-control-center"
description = "Unified agentic control center for jbcom + FlipsideCrypto"
version = "1.0.0"

# ===========================================
# JBCOM ECOSYSTEM (Python Packages)
# ===========================================

[ecosystems.jbcom]
type = "packages"
path = "packages"
description = "Python library ecosystem published to PyPI"
public_repos_org = "jbcom"
registry = "pypi"

[ecosystems.jbcom.packages.extended-data-types]
type = "python"
path = "packages/extended-data-types"
description = "Foundation utilities - all other packages depend on this"
pypi = "extended-data-types"
public_repo = "jbcom/extended-data-types"

[ecosystems.jbcom.packages.lifecyclelogging]
type = "python"
path = "packages/lifecyclelogging"
description = "Structured lifecycle logging"
pypi = "lifecyclelogging"
public_repo = "jbcom/lifecyclelogging"
depends_on = ["extended-data-types"]

[ecosystems.jbcom.packages.directed-inputs-class]
type = "python"
path = "packages/directed-inputs-class"
description = "Declarative input validation"
pypi = "directed-inputs-class"
public_repo = "jbcom/directed-inputs-class"
depends_on = ["extended-data-types"]

[ecosystems.jbcom.packages.python-terraform-bridge]
type = "python"
path = "packages/python-terraform-bridge"
description = "Terraform integration utilities"
pypi = "python-terraform-bridge"
public_repo = "jbcom/python-terraform-bridge"
depends_on = ["extended-data-types"]

[ecosystems.jbcom.packages.vendor-connectors]
type = "python"
path = "packages/vendor-connectors"
description = "Cloud vendor connectors (AWS, Google, GitHub, Slack, Vault)"
pypi = "vendor-connectors"
public_repo = "jbcom/vendor-connectors"
depends_on = ["extended-data-types", "lifecyclelogging", "directed-inputs-class"]

[ecosystems.jbcom.packages.agentic-control]
type = "nodejs"
path = "packages/agentic-control"
description = "AI agent fleet management, triage, orchestration"
npm = "agentic-control"
public_repo = "jbcom/agentic-control"

# ===========================================
# FLIPSIDE CRYPTO ECOSYSTEM (Infrastructure)
# ===========================================

[ecosystems.flipside-crypto]
type = "infrastructure"
path = "ecosystems/flipside-crypto"
description = "FlipsideCrypto AWS/GCP infrastructure"
github_org = "FlipsideCrypto"

# Terraform Modules
[ecosystems.flipside-crypto.terraform.modules]
path = "ecosystems/flipside-crypto/terraform/modules"
count = 30

[ecosystems.flipside-crypto.terraform.modules.aws]
path = "ecosystems/flipside-crypto/terraform/modules/aws"
description = "AWS infrastructure modules (70+)"

[ecosystems.flipside-crypto.terraform.modules.google]
path = "ecosystems/flipside-crypto/terraform/modules/google"
description = "Google Cloud modules (38)"

[ecosystems.flipside-crypto.terraform.modules.github]
path = "ecosystems/flipside-crypto/terraform/modules/github"
description = "GitHub organization modules"

[ecosystems.flipside-crypto.terraform.modules.terraform]
path = "ecosystems/flipside-crypto/terraform/modules/terraform"
description = "Terraform pipeline generation"

# Terraform Workspaces
[ecosystems.flipside-crypto.terraform.workspaces]
path = "ecosystems/flipside-crypto/terraform/workspaces"
total = 44

[ecosystems.flipside-crypto.terraform.workspaces.aws-organization]
path = "ecosystems/flipside-crypto/terraform/workspaces/terraform-aws-organization"
description = "AWS organization resources (37 workspaces)"
workspaces = 37

[ecosystems.flipside-crypto.terraform.workspaces.google-organization]
path = "ecosystems/flipside-crypto/terraform/workspaces/terraform-google-organization"
description = "Google Cloud organization (7 workspaces)"
workspaces = 7

# SAM Applications
[ecosystems.flipside-crypto.sam]
path = "ecosystems/flipside-crypto/sam"
description = "AWS SAM Lambda applications"

[ecosystems.flipside-crypto.sam.secrets-config]
path = "ecosystems/flipside-crypto/sam/secrets-config"
description = "Secrets configuration service"

[ecosystems.flipside-crypto.sam.secrets-merging]
path = "ecosystems/flipside-crypto/sam/secrets-merging"
description = "Secrets merging service"

[ecosystems.flipside-crypto.sam.secrets-syncing]
path = "ecosystems/flipside-crypto/sam/secrets-syncing"
description = "Secrets syncing service"

# Python Library
[ecosystems.flipside-crypto.lib]
path = "ecosystems/flipside-crypto/lib"
description = "Internal Python libraries"

[ecosystems.flipside-crypto.lib.terraform-modules]
path = "ecosystems/flipside-crypto/lib/terraform_modules"
description = "Terraform module data sources and CLI"

# Configuration
[ecosystems.flipside-crypto.config]
path = "ecosystems/flipside-crypto/config"
state_paths = "ecosystems/flipside-crypto/config/state-paths.yaml"
pipelines = "ecosystems/flipside-crypto/config/pipelines.yaml"

[ecosystems.flipside-crypto.config.terraform]
version = "1.13.1"

[ecosystems.flipside-crypto.config.backend]
bucket = "flipside-crypto-internal-tooling"
dynamodb_table = "internal-tooling-terraform-state"
region = "us-east-1"

# ===========================================
# CROSS-ECOSYSTEM DEPENDENCIES
# ===========================================

[dependencies]
# FlipsideCrypto consumes these jbcom packages
flipside-crypto-uses-jbcom = [
  "vendor-connectors",
  "lifecyclelogging",
  "extended-data-types",
]

# ===========================================
# AGENT CONFIGURATION
# ===========================================

[agent]
config = "agentic.config.json"
rules = ".ruler/AGENTS.md"
package = "agentic-control"

[agent.tokens]
jbcom = "GITHUB_JBCOM_TOKEN"
flipside-crypto = "GITHUB_FSC_TOKEN"
pr_reviews = "GITHUB_JBCOM_TOKEN"

[agent.memory]
jbcom = "memory-bank"
flipside-crypto = "ecosystems/flipside-crypto/memory-bank"
