# Agentic Rules

Stable reference for AI agent behavior in this repository.

---

## üö® MANDATORY SESSION START (READ FIRST - NO EXCEPTIONS)

**BEFORE doing ANYTHING else, read ALL tooling documentation:**

```bash
# 1. Memory Bank State
cat memory-bank/activeContext.md
cat memory-bank/progress.md
cat memory-bank/agenticRules.md

# 2. YOUR OWN TOOLING (YOU MUST KNOW THIS)
cat docs/CURSOR-AGENT-MANAGEMENT.md
cat docs/AGENTIC-DIFF-RECOVERY.md
cat docs/AGENT-TO-AGENT-HANDOFF.md

# 3. Available Scripts
ls -la .cursor/scripts/

# 4. Recovery Directory
ls -la .cursor/recovery/
```

**YOU HAVE COMPREHENSIVE TOOLING. USE IT. NEVER ASK USER ABOUT IT.**

### Tools You MUST Know:
- `cursor-agents list/create/status/conversation` - Manage sub-agents
- `agent-triage-local` - Offline triage without MCP
- `agent-swarm-orchestrator` - Spawn parallel recovery agents
- `triage-pipeline` - Automated batch recovery
- `replay_agent_session.py` - Memory bank updates
- `aider` - AI forensic analysis

### Sub-Agent Spawning (USE THIS):
```bash
# Spawn opus 4.5 agents for specific tasks
cursor-agents create "Task description for sub-agent"

# Or create GitHub issues for async agent work
gh issue create --title "ü§ñ Agent Task: ..." --body "..."
```

---

## üß† Memory Bank (CRITICAL)

### Session Start
```bash
cat memory-bank/activeContext.md
cat memory-bank/progress.md
```

### Session End
- Update activeContext.md with current state
- Update progress.md with completions
- Run `python scripts/replay_agent_session.py` to ingest any recovered Cursor transcripts
- Commit memory-bank changes with your work

---

## üîê Authentication

### jbcom Repositories
```bash
# ALWAYS use this pattern for jbcom repos
GH_TOKEN="$GITHUB_JBCOM_TOKEN" gh <command>
```

###  Repositories
```bash
# Default token works
gh <command>
```

### Never
- Use bare `gh` commands for jbcom repos
- Commit tokens to files
- Use personal tokens in CI

---

## üì¶ Package Management

### CalVer Versioning
- Format: `YYYY.MM.BUILD` (e.g., 202511.42)
- Generated by pycalver at CI start
- Single version for entire monorepo
- NO git tags, NO GitHub releases

### Dependency Order
```
extended-data-types (FOUNDATION)
‚îú‚îÄ‚îÄ lifecyclelogging
‚îú‚îÄ‚îÄ directed-inputs-class
‚îî‚îÄ‚îÄ vendor-connectors
```

### Package Names
- PyPI: `vendor-connectors` (NOT cloud-connectors)
- Import: `from vendor_connectors import ...`

---

## üîÄ Multi-Merge Workflow

For work requiring multiple sequential PRs:

### 1. Create Holding PR
```bash
git checkout -b agent/holding-<topic>
# Add marker file
git commit -m "Agent holding PR for <topic>"
git push -u origin HEAD
GH_TOKEN="$GITHUB_JBCOM_TOKEN" gh pr create \
  --title "[HOLDING] Agent session for <topic>"
```

### 2. Create Interim PRs
```bash
git checkout main && git pull
git checkout -b fix/<specific-issue>
# Make fix
git push -u origin HEAD
gh pr create --title "Fix: <issue>"
gh pr merge --squash --delete-branch
```

### 3. Watch CI, Repeat if Needed

### 4. Close Holding PR When Done

---

## üö® Never Suggest

- ‚ùå semantic-release
- ‚ùå Git tags for versioning
- ‚ùå Manual version management
- ‚ùå GitHub releases automation
- ‚ùå Conditional release logic

---

## ‚úÖ Always Do

- ‚úÖ Use pycalver for versioning
- ‚úÖ Use uv for package management
- ‚úÖ Use unified ci.yml workflow
- ‚úÖ Use PyPI for version tracking
- ‚úÖ Update memory-bank

---

## üìã GitHub Integration

### Issues
- Create for multi-step work
- Use labels appropriately
- Link PRs with "Fixes #N" or "Part of #N"

### Projects
- Track at: [jbcom Ecosystem Integration](https://github.com/users/jbcom/projects/2)
- Add issues to project when created

### PRs
- Clear titles
- Link to issues
- Include test plan

---

## üß™ Before Creating PRs

1. Run tests locally if possible
2. Check for lint errors
3. Verify imports work
4. Update memory-bank

---

## üÜò If Stuck

1. Update memory-bank with current state
2. Document what was tried
3. Note blockers
4. Ask for guidance
