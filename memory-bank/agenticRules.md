# Agentic Rules

Stable reference for AI agent behavior in this repository.

---

## ğŸ§  Memory Bank (CRITICAL)

### Session Start
```bash
cat memory-bank/activeContext.md
cat memory-bank/progress.md
```

### Session End
- Update activeContext.md with current state
- Update progress.md with completions
- Run `python scripts/replay_agent_session.py` to ingest any recovered Cursor transcripts
- Commit memory-bank changes with your work

---

## ğŸ” Authentication

### jbcom Repositories
```bash
# ALWAYS use this pattern for jbcom repos
GH_TOKEN="$GITHUB_JBCOM_TOKEN" gh <command>
```

### FlipsideCrypto Repositories
```bash
# Default token works
gh <command>
```

### Never
- Use bare `gh` commands for jbcom repos
- Commit tokens to files
- Use personal tokens in CI

---

## ğŸ“¦ Package Management

### CalVer Versioning
- Format: `YYYY.MM.BUILD` (e.g., 202511.42)
- Generated by pycalver at CI start
- Single version for entire monorepo
- NO git tags, NO GitHub releases

### Dependency Order
```
extended-data-types (FOUNDATION)
â”œâ”€â”€ lifecyclelogging
â”œâ”€â”€ directed-inputs-class
â””â”€â”€ vendor-connectors
```

### Package Names
- PyPI: `vendor-connectors` (NOT cloud-connectors)
- Import: `from vendor_connectors import ...`

---

## ğŸ”€ Multi-Merge Workflow

For work requiring multiple sequential PRs:

### 1. Create Holding PR
```bash
git checkout -b agent/holding-<topic>
# Add marker file
git commit -m "Agent holding PR for <topic>"
git push -u origin HEAD
GH_TOKEN="$GITHUB_JBCOM_TOKEN" gh pr create \
  --title "[HOLDING] Agent session for <topic>"
```

### 2. Create Interim PRs
```bash
git checkout main && git pull
git checkout -b fix/<specific-issue>
# Make fix
git push -u origin HEAD
gh pr create --title "Fix: <issue>"
gh pr merge --squash --delete-branch
```

### 3. Watch CI, Repeat if Needed

### 4. Close Holding PR When Done

---

## ğŸš¨ Never Suggest

- âŒ semantic-release
- âŒ Git tags for versioning
- âŒ Manual version management
- âŒ GitHub releases automation
- âŒ Conditional release logic

---

## âœ… Always Do

- âœ… Use pycalver for versioning
- âœ… Use uv for package management
- âœ… Use unified ci.yml workflow
- âœ… Use PyPI for version tracking
- âœ… Update memory-bank

---

## ğŸ“‹ GitHub Integration

### Issues
- Create for multi-step work
- Use labels appropriately
- Link PRs with "Fixes #N" or "Part of #N"

### Projects
- Track at: [jbcom Ecosystem Integration](https://github.com/users/jbcom/projects/2)
- Add issues to project when created

### PRs
- Clear titles
- Link to issues
- Include test plan

---

## ğŸ§ª Before Creating PRs

1. Run tests locally if possible
2. Check for lint errors
3. Verify imports work
4. Update memory-bank

---

## ğŸ†˜ If Stuck

1. Update memory-bank with current state
2. Document what was tried
3. Note blockers
4. Ask for guidance
