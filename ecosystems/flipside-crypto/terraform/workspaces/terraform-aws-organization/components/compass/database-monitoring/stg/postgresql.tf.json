{
  "data": {
    "doppler_secrets": {
      "this": {
        "config": "stg_copilot",
        "project": "compass"
      }
    }
  },
  "locals": {
    "database_host": "${local.db_parts.host}",
    "database_name": "${local.db_parts.database}",
    "database_port": "${tonumber(local.db_parts.port)}",
    "database_url": "${data.doppler_secrets.this.map.DATABASE_URL}",
    "database_username": "${local.db_parts.username}",
    "db_parts": "${regexall(\"postgres://(?P<username>[^:]+):(?P<password>[^@]+)@(?P<host>[^:]+):(?P<port>\\\\d+)/(?P<database>[^?]+)\", local.database_url)[0]}",
    "records_config": {
      "database_host": "${local.database_host}",
      "database_monitoring": "${module.base}",
      "database_name": "${local.database_name}",
      "database_port": "${local.database_port}",
      "database_username": "${local.database_username}"
    }
  },
  "provider": {
    "postgresql": [
      {
        "database": "${local.database_name}",
        "host": "${local.database_host}",
        "password": "${local.db_parts.password}",
        "port": "${local.database_port}",
        "scheme": "awspostgres",
        "sslmode": "require",
        "superuser": false,
        "username": "${local.database_username}"
      }
    ]
  }
}