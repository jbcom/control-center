{
  "data": {
    "env_var": {
      "EXECUTION_ROLE_ARN": {
        "id": "EXECUTION_ROLE_ARN",
        "required": false
      },
      "ROLE_SESSION_NAME": {
        "id": "ROLE_SESSION_NAME",
        "required": false
      }
    }
  },
  "resource": {
    "terraform_data": {
      "default": {
        "provisioner": [
          {
            "local-exec": {
              "command": "tm_cli create_codedeploy_deployment",
              "environment": {
                "EXECUTION_ROLE_ARN": "${data.env_var.EXECUTION_ROLE_ARN.value}",
                "ROLE_SESSION_NAME": "${data.env_var.ROLE_SESSION_NAME.value}",
                "application_name": "${self.triggers_replace.application_name}",
                "checksum": "${self.triggers_replace.checksum}",
                "container_name": "${self.triggers_replace.container_name}",
                "container_port": "${self.triggers_replace.container_port}",
                "debug_markers": "${self.triggers_replace.debug_markers}",
                "deployment_group_name": "${self.triggers_replace.deployment_group_name}",
                "execution_role_arn": "${self.triggers_replace.execution_role_arn}",
                "log_file_name": "${self.triggers_replace.log_file_name}",
                "max_attempts": "${self.triggers_replace.max_attempts}",
                "params": "${self.triggers_replace.params}",
                "poll_delay": "${self.triggers_replace.poll_delay}",
                "role_session_name": "${self.triggers_replace.role_session_name}",
                "task_definition_arn": "${self.triggers_replace.task_definition_arn}",
                "verbose": "${self.triggers_replace.verbose}",
                "verbosity": "${self.triggers_replace.verbosity}"
              }
            }
          }
        ],
        "triggers_replace": {
          "application_name": "${try(nonsensitive(var.application_name), var.application_name)}",
          "checksum": "${try(nonsensitive(var.checksum), var.checksum)}",
          "container_name": "${try(nonsensitive(var.container_name), var.container_name)}",
          "container_port": "${try(nonsensitive(var.container_port), var.container_port)}",
          "debug_markers": "${try(nonsensitive(jsonencode(var.debug_markers)), jsonencode(var.debug_markers))}",
          "deployment_group_name": "${try(nonsensitive(var.deployment_group_name), var.deployment_group_name)}",
          "execution_role_arn": "${try(nonsensitive(var.execution_role_arn), var.execution_role_arn)}",
          "log_file_name": "${try(nonsensitive(var.log_file_name), var.log_file_name)}",
          "max_attempts": "${try(nonsensitive(var.max_attempts), var.max_attempts)}",
          "params": "${try(nonsensitive(base64encode(jsonencode(var.params))), base64encode(jsonencode(var.params)))}",
          "poll_delay": "${try(nonsensitive(var.poll_delay), var.poll_delay)}",
          "role_session_name": "${try(nonsensitive(var.role_session_name), var.role_session_name)}",
          "task_definition_arn": "${try(nonsensitive(var.task_definition_arn), var.task_definition_arn)}",
          "verbose": "${try(nonsensitive(var.verbose), var.verbose)}",
          "verbosity": "${try(nonsensitive(var.verbosity), var.verbosity)}"
        }
      }
    }
  },
  "terraform": {
    "required_providers": {
      "env": {
        "source": "tcarreira/env",
        "version": ">=0.2.0"
      }
    },
    "required_version": ">=1.6"
  },
  "variable": {
    "application_name": {
      "type": "string"
    },
    "checksum": {
      "default": "",
      "description": "Optional checksum to use for triggering resource updates",
      "type": "string"
    },
    "container_name": {
      "type": "string"
    },
    "container_port": {
      "type": "number"
    },
    "debug_markers": {
      "default": [],
      "description": "Identifiers to generate verbose debug statements for",
      "type": "list(string)"
    },
    "deployment_group_name": {
      "type": "string"
    },
    "execution_role_arn": {
      "default": null,
      "type": "string"
    },
    "log_file_name": {
      "default": "run.log",
      "description": "Port library parameter",
      "type": "string"
    },
    "max_attempts": {
      "default": 120,
      "type": "number"
    },
    "params": {
      "default": {},
      "description": "Override for multiple params",
      "type": "any"
    },
    "poll_delay": {
      "default": 15,
      "type": "number"
    },
    "role_session_name": {
      "default": null,
      "type": "string"
    },
    "task_definition_arn": {
      "type": "string"
    },
    "verbose": {
      "default": false,
      "description": "Port library parameter",
      "type": "bool"
    },
    "verbosity": {
      "default": 1,
      "description": "Port library parameter",
      "type": "number"
    }
  }
}