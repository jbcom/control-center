# direnv configuration - automatic environment setup
# Install direnv: https://direnv.net/
#
# This file automatically:
# 1. Sets up Python virtual environment with UV
# 2. Installs Node.js dependencies with pnpm
# 3. Configures PATH for workspace tools
#
# After editing this file, run: direnv allow

# Load system environment
dotenv_if_exists .env

# Python environment with UV
echo "ðŸ Setting up Python environment with UV..."
if command -v uv &> /dev/null; then
    # Create/activate virtual environment
    export VIRTUAL_ENV=.venv
    layout python-venv
    
    # Install all dependencies including dev tools
    # This makes ruff, mypy, pytest, etc. available
    uv sync --extra dev --all-extras
    
    echo "âœ… Python environment ready (.venv)"
else
    echo "âš ï¸  UV not found - install it first"
fi

# Node.js environment with pnpm
echo "ðŸ“¦ Setting up Node.js environment with pnpm..."
if command -v pnpm &> /dev/null; then
    # Install workspace dependencies
    pnpm install
    
    # Add node_modules/.bin to PATH for tools
    PATH_add node_modules/.bin
    
    echo "âœ… Node.js environment ready (node_modules)"
else
    echo "âš ï¸  pnpm not found - install it first"
fi

# Environment variables
export PYTHONUNBUFFERED=1
export PYTHONDONTWRITEBYTECODE=1
export DO_NOT_TRACK=1
export DISABLE_TELEMETRY=1

echo "ðŸŽ¯ Workspace ready!"
echo "  Python: $(python --version 2>&1)"
echo "  Node.js: $(node --version 2>&1)"
echo "  UV: $(uv --version 2>&1)"
echo "  pnpm: $(pnpm --version 2>&1)"
