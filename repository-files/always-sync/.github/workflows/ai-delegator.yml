# AI Delegator - Uses jbcom/control-center
# Synced from jbcom/control-center
#
# Commands: /jules <task>, /cursor <task>
name: AI Delegator

on:
  issue_comment:
    types: [created]

  workflow_dispatch:
    inputs:
      command:
        description: 'Command (e.g., /jules fix this)'
        required: true
        type: string
      issue_number:
        description: 'Issue number'
        required: true
        type: number

permissions:
  contents: read
  issues: write
  pull-requests: write

jobs:
  delegate:
    name: Delegate to AI
    if: |
      (github.event_name == 'issue_comment' &&
       github.event.issue.pull_request == null &&
       (contains(github.event.comment.body, '/jules') || contains(github.event.comment.body, '/cursor'))) ||
      github.event_name == 'workflow_dispatch'
    runs-on: ubuntu-latest
    steps:
      - uses: jbcom/control-center/actions/delegator@v1
        with:
          repo: ${{ github.repository }}
          issue: ${{ inputs.issue_number || github.event.issue.number }}
          command: ${{ inputs.command || github.event.comment.body }}
          branch: ${{ github.event.repository.default_branch || 'main' }}
        env:
          GITHUB_TOKEN: ${{ secrets.CI_GITHUB_TOKEN || secrets.GITHUB_TOKEN }}
          GOOGLE_JULES_API_KEY: ${{ secrets.GOOGLE_JULES_API_KEY }}
          CURSOR_API_KEY: ${{ secrets.CURSOR_API_KEY }}
